<mat-card class="event-registration-card mat-elevation-z0">
   <div *ngIf="(event$ | async) as event">
      <mat-card-header>
         <div mat-card-avatar>
            <mat-icon aria-hidden="false" aria-label="Example home icon">
               local_play
            </mat-icon>
         </div>
         <mat-card-title>{{ event.title }}</mat-card-title>
      </mat-card-header>
      <mat-card-content>
         <p>
            {{ event.description }}
         </p>
         <div *ngIf="hasInappropriateCareUsers">
            Volgende zorggebruikers behoren niet tot de gepaste leeftijdsgroep
            voor dit evenement:
            <ng-container *ngFor="let user of event.relevantCareUsers">
               <h5 *ngIf="!user.appropriateAgeGroup">
                  {{ user.firstName }} {{ user.lastName }}
               </h5>
            </ng-container>
         </div>
         <div
            class="mat-elevation-z4 timeslot-table"
            [hidden]="!event.registrationOnDailyBasis"
         >
            <table mat-table [dataSource]="eventSlotDataSource" matSort>
               <ng-container matColumnDef="eventSlot">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                     Wanneer
                  </th>
                  <td mat-cell *matCellDef="let row">
                     Van {{ row.startDateTime | date: 'dd-MM-yyyy HH:mm' }}
                     <br />
                     tot {{ row.endDateTime | date: 'dd-MM-yyyy HH:mm' }}
                  </td>
               </ng-container>

               <ng-container *ngFor="let user of event.relevantCareUsers">
                  <ng-container
                     *ngIf="user.appropriateAgeGroup"
                     [matColumnDef]="user.id"
                  >
                     <th mat-header-cell *matHeaderCellDef class="user-column">
                        {{ user.firstName }} {{ user.lastName }}
                     </th>
                     <td mat-cell *matCellDef="let row" class="user-column">
                        <mat-icon
                           *ngIf="
                              getSlotRegistrationStatus(
                                 row.registrations,
                                 user.id
                              ) == 1
                           "
                           matTooltip="Aanvraag tot inschrijving ontvangen, moet nog bevestigd worden door Sint-Gerardus"
                        >
                           access_time
                        </mat-icon>
                        <mat-icon
                           *ngIf="
                              getSlotRegistrationStatus(
                                 row.registrations,
                                 user.id
                              ) == 2
                           "
                           class="registration-accepted"
                           matTooltip="Inschrijving vastgelegd en bevestigd door Sint-Gerardus"
                           >check_circle_outline</mat-icon
                        >
                        <mat-icon
                           *ngIf="
                              getSlotRegistrationStatus(
                                 row.registrations,
                                 user.id
                              ) == 4
                           "
                           class="registration-rejected"
                           matTooltip="Aanvraag tot inschrijving ontvangen, deze werd echter geweigerd door Sint-Gerardus"
                           >error_outline</mat-icon
                        >
                        <button
                           mat-icon-button
                           color="primary"
                           (click)="registerCareUserOnEventSlot(row.id, user)"
                           *ngIf="
                              getSlotRegistrationStatus(
                                 row.registrations,
                                 user.id
                              ) == 0
                           "
                           matTooltip="Aanvraag tot inschrijving indienen"
                        >
                           <mat-icon>add_circle</mat-icon>
                        </button>
                     </td>
                  </ng-container>
               </ng-container>
               <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
               <tr mat-row *matRowDef="let row; columns: columnsToDisplay"></tr>
            </table>

            <mat-paginator pageSize="5"></mat-paginator>
         </div>
         <div *ngIf="!event.registrationOnDailyBasis">
            <app-single-registrations
               [careUsers]="event.relevantCareUsers"
               [eventSlots]="event.eventSlots"
            ></app-single-registrations>
         </div>
      </mat-card-content>
      <mat-card-actions align="end">
         <button mat-stroked-button color="primary" [mat-dialog-close]>
            Sluiten
         </button>
      </mat-card-actions>
   </div>
</mat-card>
